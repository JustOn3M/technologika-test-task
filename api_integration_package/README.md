# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Takeoff ‚Üî Estimator

## –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –ø–∞–∫–µ—Ç –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –º–µ–∂–¥—É –¥–≤—É–º—è —Å–µ—Ä–≤–∏—Å–∞–º–∏ AEC (–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –ò–Ω–∂–µ–Ω–µ—Ä–∏—è, –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ):

**–°–µ—Ä–≤–∏—Å Takeoff** ‚Äî —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ç–æ—á–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è –Ω–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö —á–µ—Ä—Ç–µ–∂–∞—Ö. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –æ—Ç–º–µ—á–∞—Ç—å –æ–∫–Ω–∞, –¥–≤–µ—Ä–∏, —Å—Ç–µ–Ω—ã –∏ –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ PDF/CAD —á–µ—Ä—Ç–µ–∂–∞—Ö, –∞ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (–ø–æ–¥—Å—á–µ—Ç, –ø–ª–æ—â–∞–¥–∏, –ª–∏–Ω–µ–π–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã) –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∞—Å—à—Ç–∞–±–∞ —á–µ—Ä—Ç–µ–∂–∞.

**–°–µ—Ä–≤–∏—Å Estimator** ‚Äî —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏–π –æ—Ç Takeoff –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞, –ø—Ä–∏–º–µ–Ω—è—è –ø—Ä–∞–≤–∏–ª–∞ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ —Å—Ç–∞–≤–∫–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∫ –∏–∑–º–µ—Ä–µ–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞–º.

–ü–æ—Ç–æ–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ **webhook-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º pull**: –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑–º–µ–Ω—è—é—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤ Takeoff, –æ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–ª–µ–≥—á–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Estimator, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Ç–µ–º –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ–µ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–º–µ—Ç—É —Å—Ç–æ–∏–º–æ—Å—Ç–∏. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ Estimator –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –ø—Ä–∏ —ç—Ç–æ–º –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è —Ä–∞–∑–º–µ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ webhook.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ü–æ—Ç–æ–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

–°–ª–µ–¥—É—é—â–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π –ø–æ—Ç–æ–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:

```mermaid
sequenceDiagram
    participant User
    participant TakeoffUI as Takeoff UI
    participant Takeoff as Takeoff Service
    participant Estimator as Estimator Service

    User->>TakeoffUI: Create/Update/Delete Condition or Item
    TakeoffUI->>Takeoff: Save changes
    Takeoff-->>TakeoffUI: Confirm saved

    Note over Takeoff,Estimator: Webhook notification (lightweight)
    Takeoff->>Estimator: POST /api/Conditions/PostConditionsChange
    Note right of Takeoff: Payload: documentId, pageNumber, actions[]
    Estimator->>Estimator: Log received changes
    Estimator-->>Takeoff: 200 OK

    Note over Estimator,Takeoff: Pull complete state
    Estimator->>Takeoff: GET /api/Conditions/GetAllConditionsState?documentId=X&pageNumber=Y
    Takeoff-->>Estimator: PageConditionsState (full hierarchy)

    Note over Estimator: Apply pricing rules
    Estimator->>Estimator: Recalculate cost estimate
    Estimator->>Estimator: Log new estimate to console

    Note over Estimator: Result available for UI/reporting
```

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
1. **–î–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω—è–µ—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤ Takeoff UI (–¥–æ–±–∞–≤–ª—è–µ—Ç –æ–∫–Ω–æ, –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–µ–Ω—É, —É–¥–∞–ª—è–µ—Ç –¥–≤–µ—Ä—å –∏ —Ç.–¥.)
2. **–¢—Ä–∏–≥–≥–µ—Ä webhook**: Takeoff –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å —Å –¥–µ—Ç–∞–ª—è–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è (—á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å, –Ω–æ –Ω–µ –ø–æ–ª–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è**: Estimator –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ–µ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É Takeoff
4. **–†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏**: Estimator –ø—Ä–∏–º–µ–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –∏–∑–º–µ—Ä–µ–Ω–∏—è–º –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ª–æ–≥

### –ò–µ—Ä–∞—Ä—Ö–∏—è –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö —Å–ª–µ–¥—É–µ—Ç –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –æ—Ç –æ–±–ª–∞—Å—Ç–µ–π —á–µ—Ä—Ç–µ–∂–∞ –¥–æ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π:

```mermaid
erDiagram
    PageConditionsState ||--o{ TakeoffZone : contains
    TakeoffZone ||--o{ Condition : "measured in"
    Condition ||--o{ TakeoffItem : "instances of"
    TakeoffItem ||--o{ QuantityValue : "measured as"
    Condition ||--o{ QuantityDto : "defines"
    TakeoffZone ||--|| NormalizedBoundingBoxModel : "bounded by"
    TakeoffItem ||--o{ Point : "defined by"

    PageConditionsState {
        array takeoffZones "All zones on page"
    }

    TakeoffZone {
        uuid id "Unique identifier"
        double scale "Scale factor (e.g. 100 for 1:100)"
        string name "Zone name"
        int dpi "Drawing resolution"
        NormalizedBoundingBoxModel boundingBox "Zone boundaries"
    }

    Condition {
        uuid id "Unique identifier"
        string name "Display name"
        string type "Count/Linear/Area"
        string shape "Window/Door/Column/etc"
        string category "Grouping"
        array quantities "Measurement definitions"
    }

    TakeoffItem {
        uuid id "Unique identifier"
        uuid conditionId "Parent condition"
        uuid takeoffZoneId "Parent zone"
        uuid parentTakeoffItemId "Parent item (for attachments)"
        array points "Coordinate geometry"
        double angle "Rotation angle"
        array quantityValues "Measured values"
    }

    QuantityDto {
        string name "Quantity name"
        string unitOfMeasure "Unit (ea, m¬≤, m)"
        bool excludeAttachments "Exclude child items"
    }

    QuantityValue {
        string name "Quantity name"
        string unitOfMeasure "Unit"
        double value "Measured value"
    }

    NormalizedBoundingBoxModel {
        double left "Left coordinate"
        double top "Top coordinate"
        double right "Right coordinate"
        double bottom "Bottom coordinate"
    }

    Point {
        double x "X coordinate"
        double y "Y coordinate"
    }
```

**–ü—Ä–∏–º–µ—Ä –∏–µ—Ä–∞—Ä—Ö–∏–∏:**
- **PageConditionsState**: –ß–µ—Ä—Ç–µ–∂ –ø–ª–∞–Ω–∞ —ç—Ç–∞–∂–∞, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ 1
  - **TakeoffZone**: "Floor Plan - Scale 1:100" (DPI: 300, scale: 100)
    - **Condition**: "Standard Window 1200x1500" (Type: Count, Shape: Window)
      - **TakeoffItem**: –≠–∫–∑–µ–º–ø–ª—è—Ä –æ–∫–Ω–∞ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö (150.5, 200.3)
        - **QuantityValue**: Count = 1 ea
        - **QuantityValue**: Area = 1.8 m¬≤

## –ö–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ API

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ —Å–µ—Ä–≤–∏—Å–µ Takeoff

#### `GET /api/Conditions/GetAllConditionsState`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω–æ–µ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `documentId` (UUID, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞/—á–µ—Ä—Ç–µ–∂–∞
- `pageNumber` (integer, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ (–Ω–∞—á–∏–Ω–∞—è —Å 1)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `PageConditionsState`
- –ü–æ–ª–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è TakeoffZones ‚Üí Conditions ‚Üí TakeoffItems
- –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑–º–µ—Ä–µ–Ω–∏–π (–ø–æ–¥—Å—á–µ—Ç—ã, –ø–ª–æ—â–∞–¥–∏, –ª–∏–Ω–µ–π–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã)
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—è –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è Estimator –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è webhook –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

**–ü—Ä–∏–º–µ—Ä:**
```
GET /api/Conditions/GetAllConditionsState?documentId=550e8400-e29b-41d4-a716-446655440000&pageNumber=1
```

---

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ —Å–µ—Ä–≤–∏—Å–µ Estimator

#### `POST /api/Conditions/PostConditionsChange`

–ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ webhook –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ –∏–∑–º–µ—Ä–µ–Ω–∏—è—Ö Takeoff.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** `ConditionsChange`
- `documentId` (UUID): –î–æ–∫—É–º–µ–Ω—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–∏–∑–æ—à–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- `pageNumber` (integer): –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–æ–∏–∑–æ—à–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- `actions` (array): –°–ø–∏—Å–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π Create/Update/Delete

**–û—Ç–≤–µ—Ç:** `200 OK` –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø–æ–ª—É—á–µ–Ω–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è Takeoff –≤—Å—è–∫–∏–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç, –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏–ª–∏ —É–¥–∞–ª—è–µ—Ç —É—Å–ª–æ–≤–∏—è –∏–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã takeoff.

**–ü—Ä–∏–º–µ—Ä:**
```json
POST /api/Conditions/PostConditionsChange
Content-Type: application/json

{
  "documentId": "550e8400-e29b-41d4-a716-446655440000",
  "pageNumber": 1,
  "actions": [
    {
      "orderNumber": 1,
      "actionName": "Create",
      "entityType": "Condition",
      "condition": { ... }
    }
  ]
}
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç A: Docker (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** Docker –∏ Docker Compose

**–ó–∞–ø—É—Å–∫ –æ–±–æ–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:**
```bash
docker-compose up
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- Takeoff: http://localhost:8000/docs
- Estimator: http://localhost:8001/docs

**–û—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
docker-compose down
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (Python)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** Python 3.9+

**Terminal 1 - Takeoff Service:**
```bash
cd takeoff_service
pip install -r requirements.txt
python main.py
```
‚Üí Running on http://localhost:8000 | Swagger: http://localhost:8000/docs

**Terminal 2 - Estimator Service:**
```bash
cd estimator_service
pip install -r requirements.txt
python main.py
```
‚Üí Running on http://localhost:8001 | Swagger: http://localhost:8001/docs

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**Swagger UI (–ø—Ä–æ—â–µ –≤—Å–µ–≥–æ):**
1. Open http://localhost:8001/docs
2. Find `POST /api/Conditions/PostConditionsChange`
3. Click "Try it out" ‚Üí paste `examples/sample_webhook.json`
4. Click "Execute"
5. Watch logs (docker-compose: –≤ –∫–æ–Ω—Å–æ–ª–∏ | Python: –≤ –æ–±–æ–∏—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö)

**Using cURL:**
```bash
curl -X POST http://localhost:8001/api/Conditions/PostConditionsChange \
  -H "Content-Type: application/json" \
  -d @examples/sample_webhook.json
```

## –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å

**–¢–µ—Ä–º–∏–Ω–∞–ª —Å–µ—Ä–≤–∏—Å–∞ Estimator:**
```
============================================================
üì• WEBHOOK RECEIVED: PostConditionsChange
============================================================
   Document ID: 550e8400-e29b-41d4-a716-446655440000
   Page Number: 1
   Actions: 1 change(s)
     [1] Create Condition (N/A)
‚úÖ Webhook accepted. Starting background processing...
üì§ Fetching full state from Takeoff...
   URL: http://localhost:8000/api/Conditions/GetAllConditionsState
   Params: documentId=550e8400-e29b-41d4-a716-446655440000, pageNumber=1
‚úÖ Retrieved state: 1 zone(s), 3 condition(s), 5 item(s)
üí∞ Calculating cost estimate...
üîç Starting cost calculation...
  üìç Processing zone: First Floor Plan
    üè∑Ô∏è  Standard Window (Type: Count, Rate: $200.0/EA)
      ‚úì Window #1 - Living Room: 1.0 EA √ó $200.0 = $200.00
      ‚úì Window #2 - Bedroom: 1.0 EA √ó $200.0 = $200.00
    üè∑Ô∏è  Interior Door (Type: Count, Rate: $300.0/EA)
      ‚úì Door #1 - Main Entrance: 1.0 EA √ó $300.0 = $300.00
    üè∑Ô∏è  Exterior Wall (Type: Area, Rate: $50.0/SQ.M)
      ‚úì Wall #1 - North Wall: 15.5 SQ.M √ó $50.0 = $775.00
      ‚úì Wall #2 - East Wall: 12.4 SQ.M √ó $50.0 = $620.00
‚úÖ Calculation complete: 5 items processed
============================================================
üíµ ESTIMATED COST: $2,095.00
============================================================
```

**–¢–µ—Ä–º–∏–Ω–∞–ª —Å–µ—Ä–≤–∏—Å–∞ Takeoff:**
```
üì§ GET /api/Conditions/GetAllConditionsState - documentId=550e8400-e29b-41d4-a716-446655440000, pageNumber=1
‚úÖ Returning state: 1 zone(s), 3 condition(s), 5 item(s)
INFO:     127.0.0.1:xxxxx - "GET /api/Conditions/GetAllConditionsState?documentId=550e8400-e29b-41d4-a716-446655440000&pageNumber=1 HTTP/1.1" 200 OK
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. Webhook –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Estimator
2. Estimator –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É Takeoff
3. –°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞: 2 –æ–∫–Ω–∞ ($400) + 1 –¥–≤–µ—Ä—å ($300) + 2 —Å—Ç–µ–Ω—ã ($1,395) = **$2,095**

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
api_integration_package/
‚îú‚îÄ‚îÄ README.md                      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ openapi_corrected.yaml         # –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îú‚îÄ‚îÄ integration_flow.mmd           # –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (Mermaid)
‚îú‚îÄ‚îÄ data_model.mmd                 # –î–∏–∞–≥—Ä–∞–º–º–∞ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (Mermaid)
‚îú‚îÄ‚îÄ examples/
‚îÇ   ‚îî‚îÄ‚îÄ sample_webhook.json        # –ü—Ä–∏–º–µ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ webhook
‚îú‚îÄ‚îÄ takeoff_service/
‚îÇ   ‚îú‚îÄ‚îÄ main.py                    # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø–æ—Ä—Ç 8000)
‚îÇ   ‚îú‚îÄ‚îÄ models.py                  # Pydantic –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ mock_data.py               # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ estimator_service/
    ‚îú‚îÄ‚îÄ main.py                    # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø–æ—Ä—Ç 8001)
    ‚îú‚îÄ‚îÄ models.py                  # Pydantic –º–æ–¥–µ–ª–∏
    ‚îú‚îÄ‚îÄ pricing.py                 # –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏
    ‚îî‚îÄ‚îÄ requirements.txt
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è

- **–î–∞–Ω–Ω—ã–µ –≤ –ø–∞–º—è—Ç–∏**: –ñ–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–±–µ–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
- **–¢–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π**: –ë–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- **Swagger UI**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–∫–∞—Ö `/docs`
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ö–æ–Ω—Å–æ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π –ø–æ—Ç–æ–∫

## –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

–≠—Ç–æ—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–∞–∫–µ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏:

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (–∏–∑ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏):**
- –í—Å–µ —Å—Ö–µ–º—ã, –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π –∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—É—á–µ–Ω—ã –∏–∑ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ú–æ–¥–µ–ª–∏ –≤–∫–ª—é—á–∞—é—Ç: PageConditionsState, TakeoffZone, Condition, TakeoffItem, QuantityValue

**–¢–µ—Å—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏):**
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –∏–∑–º–µ—Ä–µ–Ω–∏—è, –∏–º–µ–Ω–∞) –±—ã–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ AEC
- –ü—Ä–∏–º–µ—Ä: –∑–æ–Ω–∞ "First Floor Plan", "Standard Window 1200x1500", –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (150.5, 200.3)
- –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ [takeoff_service/mock_data.py](takeoff_service/mock_data.py)

**–ü—Ä–∞–≤–∏–ª–∞ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏):**
- –¶–µ–Ω—ã –∑–∞ –µ–¥–∏–Ω–∏—Ü—É –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏: –û–∫–Ω–∞ ($200/EA), –î–≤–µ—Ä–∏ ($300/EA), –°—Ç–µ–Ω—ã ($50/SQ.M)
- –õ–æ–≥–∏–∫–∞ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ [estimator_service/pricing.py](estimator_service/pricing.py)
- –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç ($2,095) –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –æ—Ü–µ–Ω–∫–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏

## –ü—Ä–∞–≤–∏–ª–∞ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

- –û–∫–Ω–∞: $200 –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
- –î–≤–µ—Ä–∏: $300 –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
- –°—Ç–µ–Ω—ã: $50 –∑–∞ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –º–µ—Ç—Ä